# 4D N-Body 물리 시뮬레이터 (4D N-Body Physics Simulator)

## 1. 프로젝트 개요

본 프로젝트는 웹프로그래밍 기말고사 과제로 제작된 **인터랙티브 4차원 N-Body 물리 시뮬레이터**입니다. '시간을 또 하나의 공간 축으로 간주한다면, 과거는 입자들이 이미 지나가 버린 빈 공간 좌표일 것'이라는 개인적인 가설을 시각적으로 탐구하고 검증하는 것을 목표로 합니다.

**`Three.js`**를 기반으로, 사용자는 4차원 시공간(x, y, z, t)에서 중력의 영향을 받는 입자들의 움직임을 실시간으로 관찰하고 제어할 수 있습니다. 특히, 여러 개의 브라우저 창을 통해 동일한 4D 공간을 각기 다른 3D 단면으로 동시에 관찰하는 핵심 기능을 구현했습니다.

## 2. 주요 기능

- **4D N-Body 물리 엔진:** 수백 개의 입자가 4차원 시공간에서 서로의 중력에 따라 상호작용합니다.
- **다중 창 연동 및 4D 투영:** 여러 개의 창을 열어 동일한 4D 공간을 XYZ, XYt, XZt, YZt 등 다양한 3차원 단면으로 동시에 관찰할 수 있습니다.
- **실시간 물리 상수 제어:** 중력(G), 시간 속도, 수치 안정화를 위한 Softening 값 등을 UI를 통해 실시간으로 조절할 수 있습니다.
- **과학적 현상 시각화:**
    - **흑체 복사 (Black-body Radiation):** 입자의 온도에 따라 실제 항성처럼 색상이 변하는 효과를 구현했습니다.
    - **도플러 효과 (Doppler Effect):** 특정 입자를 추적할 때, 상대 속도에 따라 입자들이 붉게(적색편이) 또는 파랗게(청색편이) 보이도록 시각화했습니다.
- **완전한 4D 카메라 컨트롤:** 자유로운 시점 이동 및 특정 입자를 추적하는 '팔로우 캠' 기능을 지원합니다.

## 3. 실행 방법 (Execution Guide)

## **※ 매우 중요 (Very Important)**

이 프로젝트는 여러 창 간의 데이터 동기화를 위해 브라우저의 **`localStorage`** API를 사용합니다. 보안 정책상 **`file://`** 프로토콜에서는 이 기능이 정상적으로 동작하지 않으므로, **반드시 로컬 웹 서버를 통해 실행해야 합니다.** 함께 첨부된 **`mongoose.exe`**를 사용하면 간단히 서버를 구동할 수 있습니다4[6](https://cpr.readthedocs.io/en/stable/opt/mongoose/docs/Usage/)[8](https://github.com/openalpr/mongoose-mit/blob/master/UserManual.md).

---

## **단계별 실행 방법 (Windows 기준)**

1. **웹 서버 준비:**
    
    압축을 해제한 프로젝트 폴더의 최상위 위치( **`index.html`** 파일이 있는 곳)에 **`mongoose.exe`** 파일을 위치시킵니다.
    
2. **웹 서버 실행:**
    
    **`mongoose.exe`** 파일을 더블 클릭하여 실행합니다. 검은색 명령 프롬프트(콘솔) 창이 나타나면 서버가 정상적으로 실행된 것입니다.
    
    > (시스템 트레이에 아이콘이 나타날 수도 있습니다.)
    > 
3. **시뮬레이터 접속:**
    
    웹 브라우저(Chrome 권장)을 **시크릿 모드**로 열고, 주소창에 아래 주소를 입력하여 접속합니다.
    
    > http://localhost:8000
    > 
4. **다중 창 기능 확인:**
    
    새로운 브라우저 창이나 탭을 여러 개 열어, 모두 같은 주소(**`http://localhost:8000`**)로 접속하면 각 창이 동기화되어 작동하는 것을 확인할 수 있습니다.
    
    **시크릿 모드로 열어야 물리 엔진이 정상적으로 작동합니다.**(가장 왼쪽위에 위치한 창이 물리량을 연산하게 되는데, 다른 크롬창과 겹쳐있으면 동작하지 않음, 시크릿 모드로 접속하면 정상적으로 실행 가능)
    
5. **서버 종료:**
    
    실행 중인 **`mongoose.exe`** 콘솔 창을 닫거나, 시스템 트레이의 아이콘을 마우스 오른쪽 버튼으로 클릭하여 종료(Exit)하면 서버가 중지됩니다.
    

## 4. 사용 설명서 (Usage Instructions)

## 기본 조작

- **입자 생성:** 좌측 컨트롤 패널에서 **`입자 소환`** 버튼을 클릭하여 시뮬레이션을 시작합니다.
- **시뮬레이션 리셋:** **`모든 입자 제거`** 버튼을 누르면 모든 입자가 사라지고 시뮬레이션이 초기화됩니다.
- **시점(Dimension) 변경:** 패널 좌측 상단의 **`Dimension X: ...`** 제목을 클릭하면, 현재 4D 공간을 어떤 3D 단면으로 볼지 선택하는 창이 나타납니다.

## 카메라 조작

| **키보드/마우스** | **자유 시점 (Free Camera)** | **입자 추적 시점 (Follow Camera)** |
| --- | --- | --- |
| **W, A, S, D** | 앞/뒤/좌/우 이동 | (카메라 회전으로 사용) |
| **Q, E** | 좌/우 회전 (Yaw) | 좌/우 궤도 선회 (Orbit) |
| **R, F** | 상/하 회전 (Pitch) | 상/하 궤도 선회 (Orbit) |
| **Space / Shift** | 위/아래 수직 이동 | (작동 안 함) |
| **마우스 휠** | 앞/뒤로 확대/축소 | 추적 대상으로부터 확대/축소 |
| **마우스 클릭** | (작동 안 함) | **다른 입자를 클릭하여 추적 대상 변경** |
- **입자 추적하기:** 씬(Scene)에 있는 아무 입자나 마우스로 클릭하면 해당 입자를 중심으로 카메라가 고정됩니다.
- **카메라 초기화:** **`카메라 리셋`** 버튼을 누르면 카메라 위치와 방향이 초기 상태로 돌아갑니다.

## 상세 제어 및 시각 효과

- **상세 제어:** 좌측 컨트롤 패널의 **`Simulation Controls`**, **`Physics Constants`**, **`Particle Initial State`** 드롭다운 메뉴를 열어 시뮬레이션의 다양한 변수를 실시간으로 조절할 수 있습니다.
    - **Softening:** 두 입자가 매우 가까워졌을 때 중력이 무한대로 발산하는 것을 막는 수치적 안정화 값입니다. 값이 클수록 안정적이지만 정확도는 떨어집니다.
- **도플러 효과:**
    1. 먼저, 추적하고 싶은 입자를 **마우스로 클릭**합니다.
    2. **`도플러 효과`** 버튼을 클릭하여 활성화합니다.
    3. 기준 입자로부터 멀어지는 입자는 **빨간색**, 가까워지는 입자는 **파란색**, 속도 차이가 없는 입자는 **흰색**으로 보입니다.

## 5. 프로젝트 구조

- **`index.html`**: 메인 HTML 파일. UI 레이아웃과 컨트롤 패널 구조를 정의합니다.
- **`style.css`**: 프로젝트의 모든 시각적 스타일(UI, 모달, 버튼 등)을 담당합니다.
- **`main.js`**: Three.js 씬 설정, 물리 엔진, 렌더링 루프, UI 이벤트 등 프로젝트의 핵심 로직이 담겨있습니다.
- **`WindowManager.js`**: 여러 브라우저 창 간의 데이터(입자, 카메라 상태 등)를 **`localStorage`**를 통해 동기화하는 클래스입니다.
- **`mongoose.exe`**: 프로젝트 실행을 위한 경량 로컬 웹 서버입니다.
- **`README.md`**: 현재 파일. 프로젝트 설명 및 사용법을 안내합니다.

## 6. 사용 기술

- Three.js
- JavaScript (ES6 Modules)
- HTML5 / CSS3